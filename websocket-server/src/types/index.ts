// Типы для WebSocket сервера

export interface Пользователь {
  id: string;
  имя: string;
  телеграм_id?: number;
  аватар?: string;
  подключен: boolean;
  в_комнате?: string | null;
  микрофон_включен: boolean;
  говорит: boolean;
  последняя_активность?: string;
}

export interface Комната {
  id: string;
  название: string;
  создатель: string;
  участники: string[]; // ID пользователей
  максимум_участников: number;
  создана: string;
  активна: boolean;
  приватная: boolean;
  пароль?: string;
}

// Входящие сообщения от клиента
export type СообщениеКлиента = 
  | { тип: 'присоединиться'; пользователь: Пользователь }
  | { тип: 'присоединиться-к-комнате'; комната_id: string; пользователь_id: string; пароль?: string }
  | { тип: 'покинуть-комнату'; комната_id: string; пользователь_id: string }
  | { тип: 'создать-комнату'; название: string; создатель: string; максимум_участников: number; приватная: boolean; пароль?: string }
  | { тип: 'webrtc-signal'; от: string; к: string; комната: string; данные: any }
  | { тип: 'микрофон-переключен'; пользователь_id: string; комната_id: string; включен: boolean }
  | { тип: 'говорит'; пользователь_id: string; комната_id: string; говорит: boolean }
  | { тип: 'получить-комнаты' }
  | { тип: 'получить-пользователей-комнаты'; комната_id: string };

// Исходящие сообщения от сервера
export type СообщениеСервера =
  | { тип: 'комнаты-обновлены'; комнаты: Комната[] }
  | { тип: 'участники-комнаты-обновлены'; комната_id: string; участники: Пользователь[] }
  | { тип: 'присоединился-к-комнате'; комната: Комната; пользователь: Пользователь }
  | { тип: 'покинул-комнату'; комната_id: string; пользователь_id: string }
  | { тип: 'комната-создана'; комната: Комната }
  | { тип: 'webrtc-signal'; от: string; к: string; комната: string; данные: any }
  | { тип: 'микрофон-переключен'; пользователь_id: string; комната_id: string; включен: boolean }
  | { тип: 'говорит'; пользователь_id: string; комната_id: string; говорит: boolean }
  | { тип: 'ошибка'; сообщение: string };