'use client';

import React, { useState, useEffect } from 'react';
import { –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ö–æ–º–Ω–∞—Ç–∞, –°–æ—Å—Ç–æ—è–Ω–∏–µ–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è } from '@/types';
import { useTelegramWebApp } from '@/hooks/useTelegramWebApp';
import { useSocket } from '@/hooks/useSocket';
import { SimpleRoomsList } from '@/components/SimpleRoomsList';
import { SimpleVoiceRoom } from '@/components/SimpleVoiceRoom';
import { v4 as uuidv4 } from 'uuid';

export default function Home() {
  const [—Å–æ—Å—Ç–æ—è–Ω–∏–µ, set–°–æ—Å—Ç–æ—è–Ω–∏–µ] = useState<–°–æ—Å—Ç–æ—è–Ω–∏–µ–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è>({
    —Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: null,
    –∫–æ–º–Ω–∞—Ç—ã: [],
    –∞–∫—Ç–∏–≤–Ω–∞—è_–∫–æ–º–Ω–∞—Ç–∞: null,
    –ø–æ–¥–∫–ª—é—á–µ–Ω–æ_–∫_—Å–µ—Ä–≤–µ—Ä—É: false,
    —Å–æ—Å—Ç–æ—è–Ω–∏–µ_–º–∏–∫—Ä–æ—Ñ–æ–Ω–∞: true,
    –≥—Ä–æ–º–∫–æ—Å—Ç—å: 50,
    –æ—à–∏–±–∫–∞: null,
    –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è: true,
  });

  const {
    –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: —Ç–µ–ª–µ–≥—Ä–∞–º_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å,
    –≥–æ—Ç–æ–≤: —Ç–µ–ª–µ–≥—Ä–∞–º_–≥–æ—Ç–æ–≤,
    –ø–æ–∫–∞–∑–∞—Ç—å–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ,
    –ø–æ–∫–∞–∑–∞—Ç—å–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ,
    –≤–∏–±—Ä–∞—Ü–∏—è
  } = useTelegramWebApp();

  // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –¥–∞–Ω–Ω—ã—Ö Telegram
  useEffect(() => {
    if (—Ç–µ–ª–µ–≥—Ä–∞–º_–≥–æ—Ç–æ–≤ && —Ç–µ–ª–µ–≥—Ä–∞–º_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å && !—Å–æ—Å—Ç–æ—è–Ω–∏–µ.—Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) {
      const –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = {
        id: uuidv4(),
        –∏–º—è: `${—Ç–µ–ª–µ–≥—Ä–∞–º_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.first_name}${—Ç–µ–ª–µ–≥—Ä–∞–º_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.last_name ? ` ${—Ç–µ–ª–µ–≥—Ä–∞–º_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.last_name}` : ''}`,
        —Ç–µ–ª–µ–≥—Ä–∞–º_id: —Ç–µ–ª–µ–≥—Ä–∞–º_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.id,
        –∞–≤–∞—Ç–∞—Ä: —Ç–µ–ª–µ–≥—Ä–∞–º_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.photo_url,
        –ø–æ–¥–∫–ª—é—á–µ–Ω: true,
        –º–∏–∫—Ä–æ—Ñ–æ–Ω_–≤–∫–ª—é—á–µ–Ω: true,
        –≥–æ–≤–æ—Ä–∏—Ç: false,
      };

      set–°–æ—Å—Ç–æ—è–Ω–∏–µ(prev => ({
        ...prev,
        —Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å,
        –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è: false,
      }));
    } else if (—Ç–µ–ª–µ–≥—Ä–∞–º_–≥–æ—Ç–æ–≤ && !—Ç–µ–ª–µ–≥—Ä–∞–º_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) {
      // –°–æ–∑–¥–∞–µ–º –≥–æ—Å—Ç–µ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –µ—Å–ª–∏ Telegram –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
      const –≥–æ—Å—Ç–µ–≤–æ–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å = {
        id: uuidv4(),
        –∏–º—è: `–ì–æ—Å—Ç—å_${Math.random().toString(36).substr(2, 5)}`,
        –ø–æ–¥–∫–ª—é—á–µ–Ω: true,
        –º–∏–∫—Ä–æ—Ñ–æ–Ω_–≤–∫–ª—é—á–µ–Ω: true,
        –≥–æ–≤–æ—Ä–∏—Ç: false,
      };

      set–°–æ—Å—Ç–æ—è–Ω–∏–µ(prev => ({
        ...prev,
        —Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –≥–æ—Å—Ç–µ–≤–æ–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å,
        –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è: false,
      }));
    }
  }, [—Ç–µ–ª–µ–≥—Ä–∞–º_–≥–æ—Ç–æ–≤, —Ç–µ–ª–µ–≥—Ä–∞–º_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —Å–æ—Å—Ç–æ—è–Ω–∏–µ.—Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å]);

  const {
    socket,
    –ø–æ–¥–∫–ª—é—á–µ–Ω–æ,
    –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è: –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è_—Å–æ–∫–µ—Ç,
    –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è_–∫_–∫–æ–º–Ω–∞—Ç–µ,
    –ø–æ–∫–∏–Ω—É—Ç—å_–∫–æ–º–Ω–∞—Ç—É,
    —Å–æ–∑–¥–∞—Ç—å_–∫–æ–º–Ω–∞—Ç—É,
  } = useSocket({
    —Å–µ—Ä–≤–µ—ÄUrl: process.env.NEXT_PUBLIC_WEBSOCKET_URL || 'ws://localhost:8080',
    –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: —Å–æ—Å—Ç–æ—è–Ω–∏–µ.—Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å,
    –Ω–∞_–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ_–∫–æ–º–Ω–∞—Ç: (–∫–æ–º–Ω–∞—Ç—ã: –ö–æ–º–Ω–∞—Ç–∞[]) => {
      set–°–æ—Å—Ç–æ—è–Ω–∏–µ(prev => ({ ...prev, –∫–æ–º–Ω–∞—Ç—ã }));
    },
    –Ω–∞_–æ—à–∏–±–∫—É: (–æ—à–∏–±–∫–∞: string) => {
      set–°–æ—Å—Ç–æ—è–Ω–∏–µ(prev => ({ ...prev, –æ—à–∏–±–∫–∞ }));
      –ø–æ–∫–∞–∑–∞—Ç—å–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ(`–û—à–∏–±–∫–∞: ${–æ—à–∏–±–∫–∞}`);
    },
  });

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
  useEffect(() => {
    set–°–æ—Å—Ç–æ—è–Ω–∏–µ(prev => ({
      ...prev,
      –ø–æ–¥–∫–ª—é—á–µ–Ω–æ_–∫_—Å–µ—Ä–≤–µ—Ä—É: –ø–æ–¥–∫–ª—é—á–µ–Ω–æ,
      –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è: –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è_—Å–æ–∫–µ—Ç,
    }));
  }, [–ø–æ–¥–∫–ª—é—á–µ–Ω–æ, –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è_—Å–æ–∫–µ—Ç]);

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã
  const –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Å–æ–∑–¥–∞–Ω–∏–µ_–∫–æ–º–Ω–∞—Ç—ã = async (
    –Ω–∞–∑–≤–∞–Ω–∏–µ: string,
    –º–∞–∫—Å–∏–º—É–º_—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: number,
    –ø—Ä–∏–≤–∞—Ç–Ω–∞—è: boolean,
    –ø–∞—Ä–æ–ª—å?: string
  ) => {
    if (!—Å–æ—Å—Ç–æ—è–Ω–∏–µ.—Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) return;

    try {
      —Å–æ–∑–¥–∞—Ç—å_–∫–æ–º–Ω–∞—Ç—É(–Ω–∞–∑–≤–∞–Ω–∏–µ, –º–∞–∫—Å–∏–º—É–º_—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –ø—Ä–∏–≤–∞—Ç–Ω–∞—è, –ø–∞—Ä–æ–ª—å);
      –≤–∏–±—Ä–∞—Ü–∏—è();
      –ø–æ–∫–∞–∑–∞—Ç—å–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ('–ö–æ–º–Ω–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞!');
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã:', error);
      –ø–æ–∫–∞–∑–∞—Ç—å–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É');
    }
  };

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ –∫–æ–º–Ω–∞—Ç–µ
  const –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ_–∫_–∫–æ–º–Ω–∞—Ç–µ = async (–∫–æ–º–Ω–∞—Ç–∞_id: string, –ø–∞—Ä–æ–ª—å?: string) => {
    if (!—Å–æ—Å—Ç–æ—è–Ω–∏–µ.—Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) return;

    try {
      –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è_–∫_–∫–æ–º–Ω–∞—Ç–µ(–∫–æ–º–Ω–∞—Ç–∞_id, –ø–∞—Ä–æ–ª—å);
      –≤–∏–±—Ä–∞—Ü–∏—è();

      // –ù–∞—Ö–æ–¥–∏–º –∫–æ–º–Ω–∞—Ç—É –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–∞–∫ –∞–∫—Ç–∏–≤–Ω—É—é
      const –∫–æ–º–Ω–∞—Ç–∞ = —Å–æ—Å—Ç–æ—è–Ω–∏–µ.–∫–æ–º–Ω–∞—Ç—ã.find(r => r.id === –∫–æ–º–Ω–∞—Ç–∞_id);
      if (–∫–æ–º–Ω–∞—Ç–∞) {
        set–°–æ—Å—Ç–æ—è–Ω–∏–µ(prev => ({ ...prev, –∞–∫—Ç–∏–≤–Ω–∞—è_–∫–æ–º–Ω–∞—Ç–∞: –∫–æ–º–Ω–∞—Ç–∞ }));
      }
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ –∫–æ–º–Ω–∞—Ç–µ:', error);
      –ø–æ–∫–∞–∑–∞—Ç—å–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ('–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ');
    }
  };

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã—Ö–æ–¥–∞ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã
  const –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–≤—ã—Ö–æ–¥_–∏–∑_–∫–æ–º–Ω–∞—Ç—ã = async () => {
    if (!—Å–æ—Å—Ç–æ—è–Ω–∏–µ.—Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å || !—Å–æ—Å—Ç–æ—è–Ω–∏–µ.–∞–∫—Ç–∏–≤–Ω–∞—è_–∫–æ–º–Ω–∞—Ç–∞) return;

    const –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ = await –ø–æ–∫–∞–∑–∞—Ç—å–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø–æ–∫–∏–Ω—É—Ç—å –∫–æ–º–Ω–∞—Ç—É?');
    if (!–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ) return;

    try {
      –ø–æ–∫–∏–Ω—É—Ç—å_–∫–æ–º–Ω–∞—Ç—É(—Å–æ—Å—Ç–æ—è–Ω–∏–µ.–∞–∫—Ç–∏–≤–Ω–∞—è_–∫–æ–º–Ω–∞—Ç–∞.id);
      set–°–æ—Å—Ç–æ—è–Ω–∏–µ(prev => ({ ...prev, –∞–∫—Ç–∏–≤–Ω–∞—è_–∫–æ–º–Ω–∞—Ç–∞: null }));
      –≤–∏–±—Ä–∞—Ü–∏—è();
      –ø–æ–∫–∞–∑–∞—Ç—å–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ('–í—ã –ø–æ–∫–∏–Ω—É–ª–∏ –∫–æ–º–Ω–∞—Ç—É');
    } catch (error) {
      console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã:', error);
      –ø–æ–∫–∞–∑–∞—Ç—å–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–∫–∏–Ω—É—Ç—å –∫–æ–º–Ω–∞—Ç—É');
    }
  };

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ WebSocket
  useEffect(() => {
    if (!socket) return;

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ –∫–æ–º–Ω–∞—Ç–µ
    const unsubscribe–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ = socket.on('–ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è-–∫-–∫–æ–º–Ω–∞—Ç–µ', (–¥–∞–Ω–Ω—ã–µ: any) => {
      const { –∫–æ–º–Ω–∞—Ç–∞ } = –¥–∞–Ω–Ω—ã–µ;
      set–°–æ—Å—Ç–æ—è–Ω–∏–µ(prev => ({ ...prev, –∞–∫—Ç–∏–≤–Ω–∞—è_–∫–æ–º–Ω–∞—Ç–∞: –∫–æ–º–Ω–∞—Ç–∞ }));
      –ø–æ–∫–∞–∑–∞—Ç—å–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∫–æ–º–Ω–∞—Ç—É \"${–∫–æ–º–Ω–∞—Ç–∞.–Ω–∞–∑–≤–∞–Ω–∏–µ}\"!`);
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã—Ö–æ–¥–∞ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã
    const unsubscribe–í—ã—Ö–æ–¥ = socket.on('–ø–æ–∫–∏–Ω—É–ª-–∫–æ–º–Ω–∞—Ç—É', (–¥–∞–Ω–Ω—ã–µ: any) => {
      set–°–æ—Å—Ç–æ—è–Ω–∏–µ(prev => ({ ...prev, –∞–∫—Ç–∏–≤–Ω–∞—è_–∫–æ–º–Ω–∞—Ç–∞: null }));
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã
    const unsubscribe–°–æ–∑–¥–∞–Ω–∏–µ = socket.on('–∫–æ–º–Ω–∞—Ç–∞-—Å–æ–∑–¥–∞–Ω–∞', (–¥–∞–Ω–Ω—ã–µ: any) => {
      const { –∫–æ–º–Ω–∞—Ç–∞ } = –¥–∞–Ω–Ω—ã–µ;
      if (–∫–æ–º–Ω–∞—Ç–∞.—Å–æ–∑–¥–∞—Ç–µ–ª—å === —Å–æ—Å—Ç–æ—è–Ω–∏–µ.—Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å?.id) {
        set–°–æ—Å—Ç–æ—è–Ω–∏–µ(prev => ({ ...prev, –∞–∫—Ç–∏–≤–Ω–∞—è_–∫–æ–º–Ω–∞—Ç–∞: –∫–æ–º–Ω–∞—Ç–∞ }));
      }
    });

    return () => {
      unsubscribe–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ();
      unsubscribe–í—ã—Ö–æ–¥();
      unsubscribe–°–æ–∑–¥–∞–Ω–∏–µ();
    };
  }, [socket, —Å–æ—Å—Ç–æ—è–Ω–∏–µ.—Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å?.id, –ø–æ–∫–∞–∑–∞—Ç—å–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ]);

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –ø–æ–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
  if (—Å–æ—Å—Ç–æ—è–Ω–∏–µ.–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è || !—Å–æ—Å—Ç–æ—è–Ω–∏–µ.—Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å) {
    return (
      <div className="min-h-screen bg-gradient-to-b from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center">
        <div className="text-center space-y-4">
          <div className="text-6xl">üé§</div>
          <div className="text-xl font-bold text-gray-800 dark:text-white">
            –ì–æ–ª–æ—Å–æ–≤—ã–µ –∫–æ–º–Ω–∞—Ç—ã
          </div>
          <div className="text-gray-600 dark:text-gray-300">
            –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...
          </div>
          <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"></div>
        </div>
      </div>
    );
  }

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
  if (!—Å–æ—Å—Ç–æ—è–Ω–∏–µ.–ø–æ–¥–∫–ª—é—á–µ–Ω–æ_–∫_—Å–µ—Ä–≤–µ—Ä—É && !–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è_—Å–æ–∫–µ—Ç) {
    return (
      <div className="min-h-screen bg-gradient-to-b from-red-50 to-pink-100 dark:from-red-900 dark:to-pink-900 flex items-center justify-center p-4">
        <div className="text-center space-y-4 max-w-md">
          <div className="text-6xl">‚ö†Ô∏è</div>
          <div className="text-xl font-bold text-gray-800 dark:text-white">
            –ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É
          </div>
          <div className="text-gray-600 dark:text-gray-300">
            –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞
          </div>
          <button
            onClick={() => window.location.reload()}
            className="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg transition-colors"
          >
            üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å
          </button>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-gradient-to-b from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800">
      {/* –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è */}
      <div className={`
        w-full py-2 px-4 text-center text-sm font-medium
        ${—Å–æ—Å—Ç–æ—è–Ω–∏–µ.–ø–æ–¥–∫–ª—é—á–µ–Ω–æ_–∫_—Å–µ—Ä–≤–µ—Ä—É 
          ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200' 
          : 'bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200'
        }
      `}>
        {—Å–æ—Å—Ç–æ—è–Ω–∏–µ.–ø–æ–¥–∫–ª—é—á–µ–Ω–æ_–∫_—Å–µ—Ä–≤–µ—Ä—É ? 'üü¢ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ —Å–µ—Ä–≤–µ—Ä—É' : 'üü° –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...'}
      </div>

      {/* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */}
      {—Å–æ—Å—Ç–æ—è–Ω–∏–µ.–∞–∫—Ç–∏–≤–Ω–∞—è_–∫–æ–º–Ω–∞—Ç–∞ ? (
        <SimpleVoiceRoom
          –∫–æ–º–Ω–∞—Ç–∞={—Å–æ—Å—Ç–æ—è–Ω–∏–µ.–∞–∫—Ç–∏–≤–Ω–∞—è_–∫–æ–º–Ω–∞—Ç–∞}
          —Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å={—Å–æ—Å—Ç–æ—è–Ω–∏–µ.—Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å}
          socket={socket}
          –Ω–∞_–ø–æ–∫–∏–Ω—É—Ç—å_–∫–æ–º–Ω–∞—Ç—É={–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–≤—ã—Ö–æ–¥_–∏–∑_–∫–æ–º–Ω–∞—Ç—ã}
        />
      ) : (
        <SimpleRoomsList
          –∫–æ–º–Ω–∞—Ç—ã={—Å–æ—Å—Ç–æ—è–Ω–∏–µ.–∫–æ–º–Ω–∞—Ç—ã}
          –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å={—Å–æ—Å—Ç–æ—è–Ω–∏–µ.—Ç–µ–∫—É—â–∏–π_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å}
          –Ω–∞_–ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ={–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_–ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ_–∫_–∫–æ–º–Ω–∞—Ç–µ}
          –Ω–∞_—Å–æ–∑–¥–∞–Ω–∏–µ_–∫–æ–º–Ω–∞—Ç—ã={–æ–±—Ä–∞–±–æ—Ç–∞—Ç—å_—Å–æ–∑–¥–∞–Ω–∏–µ_–∫–æ–º–Ω–∞—Ç—ã}
          –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è={–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è_—Å–æ–∫–µ—Ç}
        />
      )}

      {/* –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ */}
      {—Å–æ—Å—Ç–æ—è–Ω–∏–µ.–æ—à–∏–±–∫–∞ && (
        <div className="fixed bottom-4 left-4 right-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-200 px-4 py-3 rounded-lg shadow-lg">
          <div className="flex items-center justify-between">
            <span>‚ùå {—Å–æ—Å—Ç–æ—è–Ω–∏–µ.–æ—à–∏–±–∫–∞}</span>
            <button
              onClick={() => set–°–æ—Å—Ç–æ—è–Ω–∏–µ(prev => ({ ...prev, –æ—à–∏–±–∫–∞: null }))}
              className="ml-4 text-red-500 hover:text-red-700"
            >
              ‚úï
            </button>
          </div>
        </div>
      )}
    </div>
  );
}
