#!/bin/bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ WebSocket URL –Ω–∞ –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

echo "üîÑ –û–ë–ù–û–í–õ–ï–ù–ò–ï WEBSOCKET URL"
echo "==========================="
echo

cd /root/TelegramVoice/mini-app

# –û–±–Ω–æ–≤–ª—è–µ–º .env.production
echo "NEXT_PUBLIC_WEBSOCKET_URL=ws://89.23.115.156:8080" > .env.production

echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω .env.production"
cat .env.production

# –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
echo
echo "üî® –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è..."
npm run build

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
echo
echo "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞..."
pm2 restart frontend

echo
echo "‚úÖ –ì–æ—Ç–æ–≤–æ! WebSocket —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: ws://89.23.115.156:8080"
echo
echo "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: http://89.23.115.156:3000"